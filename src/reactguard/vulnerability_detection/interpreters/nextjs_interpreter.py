# SPDX-FileCopyrightText: 2025 Theori Inc.
# SPDX-License-Identifier: AGPL-3.0-or-later

"""Next.js-specific multi-action interpreter for CVE-2025-55182."""

from __future__ import annotations

from dataclasses import dataclass

from .base import Rule
from .multi_action import (
    MultiActionAnalyzer,
    MultiActionContext,
    _rule_nextjs_dev_overlay,
    _rule_success_path,
    default_multi_action_rules,
    insert_rule,
)


@dataclass
class NextjsInterpreter(MultiActionAnalyzer):
    framework: str = "nextjs"

    def rules(self) -> list[Rule[MultiActionContext]]:
        return insert_rule(default_multi_action_rules(), _rule_nextjs_dev_overlay, after=_rule_success_path)
